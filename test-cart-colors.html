<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test Cart Color Images</title>
    <style>
        body { font-family: Arial; max-width: 1200px; margin: 0 auto; padding: 20px; }
        button { padding: 10px 20px; margin: 10px; }
        .result { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; }
        pre { background: #333; color: #fff; padding: 10px; overflow: auto; }
        .item { border: 1px solid #ddd; padding: 10px; margin: 10px 0; display: flex; align-items: center; }
        .item img { width: 100px; height: 100px; object-fit: cover; margin-right: 20px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Test Cart Color Images</h1>
    
    <button onclick="clearCart()">1. Clear Cart</button>
    <button onclick="addAtlas()">2. Add Atlas Variant</button>
    <button onclick="addPolished()">3. Add Polished Variant</button>
    <button onclick="getCart()">4. Show Cart</button>
    
    <div id="results"></div>
    
    <script>
        const baseUrl = 'http://localhost:3000/lg/API/v1/cart/cart.php';
        
        async function clearCart() {
            try {
                const response = await fetch(baseUrl + '?action=clear', {
                    method: 'POST',
                    credentials: 'include'
                });
                const data = await response.json();
                document.getElementById('results').innerHTML = '<div class="result success">Cart cleared!</div>';
            } catch (error) {
                document.getElementById('results').innerHTML = '<div class="result error">Error: ' + error.message + '</div>';
            }
        }
        
        async function addAtlas() {
            try {
                const response = await fetch(baseUrl + '?action=add', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({
                        product_id: 91754,
                        quantity: 1,
                        size: 'XLT',
                        color: 'Atlas'
                    })
                });
                const data = await response.json();
                document.getElementById('results').innerHTML = '<div class="result success">Added Atlas variant!</div>';
            } catch (error) {
                document.getElementById('results').innerHTML = '<div class="result error">Error: ' + error.message + '</div>';
            }
        }
        
        async function addPolished() {
            try {
                const response = await fetch(baseUrl + '?action=add', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({
                        product_id: 91754,
                        quantity: 1,
                        size: '3LT',
                        color: 'Polished'
                    })
                });
                const data = await response.json();
                document.getElementById('results').innerHTML = '<div class="result success">Added Polished variant!</div>';
            } catch (error) {
                document.getElementById('results').innerHTML = '<div class="result error">Error: ' + error.message + '</div>';
            }
        }
        
        async function getCart() {
            try {
                const response = await fetch(baseUrl + '?action=get', {
                    credentials: 'include'
                });
                const data = await response.json();
                
                let html = '<div class="result"><h3>Cart Contents:</h3>';
                
                if (data.data && data.data.cart_items && data.data.cart_items.length > 0) {
                    data.data.cart_items.forEach(item => {
                        html += `
                            <div class="item">
                                <img src="${item.image || '/no-image.png'}" alt="${item.name}">
                                <div>
                                    <h4>${item.name}</h4>
                                    <p>Size: ${item.size} | Color: ${item.color}</p>
                                    <p>Price: $${item.price} | Qty: ${item.quantity}</p>
                                    <p style="font-size: 10px;">Image URL: ${item.image}</p>
                                </div>
                            </div>
                        `;
                    });
                } else {
                    html += '<p>Cart is empty</p>';
                }
                
                html += '</div>';
                document.getElementById('results').innerHTML = html;
                
                // Also show raw JSON
                console.log('Cart data:', data);
            } catch (error) {
                document.getElementById('results').innerHTML = '<div class="result error">Error: ' + error.message + '</div>';
            }
        }
    </script>
</body>
</html>